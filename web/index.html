<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ü™ô ColCript - Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <h1 class="logo">ü™ô ColCript</h1>
                <div class="header-info">
                    <span class="version">v1.1.0</span>
                    <div class="connection-status" id="connectionStatus">
                        <span class="status-dot"></span>
                        <span>Conectando...</span>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="container">
            <div class="nav-links">
                <a href="#" class="nav-link active" data-page="dashboard">
                    <span>üìä</span> Dashboard
                </a>
                <a href="#" class="nav-link" data-page="wallet">
                    <span>üíº</span> Wallet
                </a>
                <a href="#" class="nav-link" data-page="mining">
                    <span>‚õèÔ∏è</span> Miner√≠a
                </a>
                <a href="#" class="nav-link" data-page="explorer">
                    <span>üîç</span> Explorador
                </a>
                <a href="#" class="nav-link" data-page="faucet">
                    <span>üéÅ</span> Faucet
                </a>
                <a href="#" class="nav-link" data-page="contracts">
                    <span>üìú</span> Contratos
                </a>
                <a href="#" class="nav-link" data-page="network">
                    <span>üåê</span> Red P2P
                </a>
                <a href="#" class="nav-link" data-page="pool">
                    <span>‚õèÔ∏è</span> Mining Pool
                </a>
                <a href="#" class="nav-link" data-page="settings">
                    <span>‚öôÔ∏è</span> Ajustes
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Dashboard Page -->
            <div class="page active" id="dashboard">
                <h2 class="page-title">üìä Dashboard</h2>
                
                <!-- Stats Grid -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üí∞</div>
                        <div class="stat-content">
                            <div class="stat-label">Supply Circulante</div>
                            <div class="stat-value" id="circulating">-- CLC</div>
                            <div class="stat-change">de 21,000,000 CLC</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">‚õìÔ∏è</div>
                        <div class="stat-content">
                            <div class="stat-label">Total Bloques</div>
                            <div class="stat-value" id="totalBlocks">--</div>
                            <div class="stat-change">blockchain v√°lida</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">‚öôÔ∏è</div>
                        <div class="stat-content">
                            <div class="stat-label">Dificultad</div>
                            <div class="stat-value" id="difficulty">--</div>
                            <div class="stat-change" id="difficultyStatus">--</div>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon">üíº</div>
                        <div class="stat-content">
                            <div class="stat-label">Mi Balance</div>
                            <div class="stat-value" id="myBalance">-- CLC</div>
                            <div class="stat-change" id="walletStatus">Sin wallet</div>
                        </div>
                    </div>
                </div>

                <!-- Charts -->
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3>üìà Supply en Circulaci√≥n</h3>
                        <canvas id="supplyChart"></canvas>
                    </div>
                    
                    <div class="chart-card">
                        <h3>üíº Top Wallets</h3>
                        <canvas id="walletsChart"></canvas>
                    </div>
                </div>

                <!-- Recent Blocks -->
                <div class="section-card">
                    <h3>üîó √öltimos Bloques</h3>
                    <div id="recentBlocks" class="blocks-list">
                        <p class="loading">Cargando bloques...</p>
                    </div>
                </div>
            </div>
            <!-- Wallet Page -->
            <div class="page" id="wallet">
                <h2 class="page-title">üíº Wallet Manager</h2>
                
                <!-- Wallet Type Selection -->
                <div class="section-card">
                    <h3>Select Wallet Type</h3>
                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                        <button class="btn btn-secondary" onclick="showWalletType('standard')" id="btnStandardWallet">
                            üîë Standard Wallet
                        </button>
                        <button class="btn btn-primary" onclick="showWalletType('hd')" id="btnHDWallet">
                            üîê HD Wallet (Recommended)
                        </button>
                    </div>
                </div>
                
                <!-- Standard Wallet Section -->
                <div id="standardWalletSection" style="display: none;">
                    <div class="section-card">
                        <h3>üîë Standard Wallet</h3>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <button class="btn btn-primary" onclick="createWallet()">
                                ‚ûï Create New
                            </button>
                            <button class="btn btn-secondary" onclick="document.getElementById('walletFileInput').click()">
                                üìÇ Load Wallet
                            </button>
                        </div>
                        <input type="file" id="walletFileInput" accept=".json" style="display: none;" onchange="loadWalletFromFile(event)">
                        
                        <div id="walletInfo"></div>
                    </div>
                </div>
                
                <!-- HD Wallet Section -->
                <div id="hdWalletSection" style="display: none;">
                    <!-- Create/Restore HD Wallet -->
                    <div class="section-card">
                        <h3>üîê HD Wallet</h3>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <button class="btn btn-primary" onclick="createHDWallet()">
                                ‚ú® Create New HD Wallet
                            </button>
                            <button class="btn btn-secondary" onclick="showRestoreHDWallet()">
                                üîÑ Restore from Mnemonic
                            </button>
                            <button class="btn btn-secondary" onclick="loadExistingHDWallet()">
                                üìÇ Load Existing
                            </button>
                        </div>
                        
                        <!-- Restore Form -->
                        <div id="restoreHDForm" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--dark); border-radius: 8px;">
                            <h4>Restore HD Wallet</h4>
                            <div class="form-group">
                                <label>12-Word Mnemonic Phrase</label>
                                <textarea id="mnemonicInput" rows="3" placeholder="word1 word2 word3 ..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>Wallet Name</label>
                                <input type="text" id="restoreNameInput" placeholder="MyRestoredWallet">
                            </div>
                            <button class="btn btn-primary" onclick="restoreHDWallet()">
                                üîÑ Restore Wallet
                            </button>
                        </div>
                        
                        <div id="hdWalletInfo"></div>
                    </div>
                    
                    <!-- HD Addresses -->
                    <div class="section-card" id="hdAddressesSection" style="display: none;">
                        <h3>üìã Derived Addresses</h3>
                        <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                            <button class="btn btn-primary" onclick="deriveNewAddress()">
                                ‚ûï Derive New Address
                            </button>
                            <button class="btn btn-secondary" onclick="deriveMultipleAddresses()">
                                ‚ûï‚ûï Derive 5 Addresses
                            </button>
                            <button class="btn btn-secondary" onclick="showMnemonic()">
                                üîë Show Mnemonic
                            </button>
                        </div>
                        <div id="hdAddressesList"></div>
                    </div>
                </div>
                
                <!-- Balance & Transactions (Common) -->
                <div class="section-card" id="balanceSection" style="display: none;">
                    <h3>üí∞ Balance</h3>
                    <div id="balanceInfo">
                        <p class="loading">Load a wallet to see balance</p>
                    </div>
                </div>
                
                <div class="section-card" id="transactionsSection" style="display: none;">
                    <h3>üìú Transaction History</h3>
                    <div id="transactionHistory">
                        <p class="loading">Load a wallet to see transactions</p>
                    </div>
                </div>
            </div>

            <!-- Mining Page -->
            <div class="page" id="mining">
                <h2 class="page-title">‚õèÔ∏è Miner√≠a</h2>
                
                <div class="mining-grid">
                    <div class="section-card">
                        <h3>Control de Miner√≠a</h3>
                        <div class="mining-stats">
                            <div class="mining-stat">
                                <span>Recompensa:</span>
                                <strong id="miningReward">50 CLC</strong>
                            </div>
                            <div class="mining-stat">
                                <span>Dificultad:</span>
                                <strong id="miningDifficulty">4</strong>
                            </div>
                            <div class="mining-stat">
                                <span>Tx Pendientes:</span>
                                <strong id="pendingTx">0</strong>
                            </div>
                        </div>
                        <button class="btn btn-primary btn-large" id="mineBtn" onclick="mineBlock()">
                            ‚õèÔ∏è Minar Bloque
                        </button>
                        <div id="miningStatus" class="mining-status"></div>
                    </div>

                    <div class="section-card">
                        <h3>üìä Estad√≠sticas de Miner√≠a</h3>
                        <div id="miningStatsContent">
                            <p class="loading">Cargando estad√≠sticas...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Explorer Page -->
            <div class="page" id="explorer">
                <h2 class="page-title">üîç Explorador de Bloques</h2>
                
                <div class="section-card">
                    <h3>Buscar Bloque</h3>
                    <div class="search-group">
                        <input type="number" id="blockNumber" placeholder="N√∫mero de bloque">
                        <button class="btn btn-primary" onclick="searchBlock()">Buscar</button>
                    </div>
                </div>

                <div id="blockDetails" class="section-card" style="display: none;">
                    <h3>Detalles del Bloque</h3>
                    <div id="blockDetailsContent"></div>
                </div>

                <div class="section-card">
                    <h3>Todos los Bloques</h3>
                    <div id="allBlocks"></div>
                </div>
            </div>

            <!-- Faucet Page -->
            <div class="page" id="faucet">
                <h2 class="page-title">üéÅ Faucet - CLC Gratis</h2>
                
                <div class="faucet-grid">
                    <div class="section-card faucet-card">
                        <div class="faucet-icon">üéÅ</div>
                        <h3>Reclama 5 CLC Gratis</h3>
                        <p>Recibe ColCript gratis cada 24 horas</p>
                        <div id="faucetInfo" class="faucet-info">
                            <p class="loading">Cargando informaci√≥n...</p>
                        </div>
                        <button class="btn btn-primary btn-large" onclick="claimFaucet()">
                            Reclamar Ahora
                        </button>
                    </div>
                </div>
            </div>

            <!-- Contracts Page -->
            <div class="page" id="contracts">
                <h2 class="page-title">üìú Smart Contracts</h2>
                
                <div class="contracts-grid">
                    <!-- Create Contracts -->
                    <div class="section-card">
                        <h3>Crear Contrato</h3>
                        <div class="form-group">
                            <label>Tipo de Contrato</label>
                            <select id="contractType" onchange="showContractForm()">
                                <option value="">Seleccionar...</option>
                                <option value="timelock">Timelock</option>
                                <option value="multisig">Multisig</option>
                                <option value="escrow">Escrow</option>
                            </select>
                        </div>
                        
                        <!-- Timelock Form -->
                        <div id="timelockForm" style="display: none;">
                            <div class="form-group">
                                <label>Bloque de Desbloqueo</label>
                                <input type="number" id="unlockBlock" placeholder="10">
                            </div>
                            <div class="form-group">
                                <label>Cantidad (CLC)</label>
                                <input type="number" id="contractAmount" placeholder="50" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Destinatario</label>
                                <input type="text" id="contractRecipient" placeholder="Direcci√≥n">
                            </div>
                            <button class="btn btn-primary" onclick="createTimelockContract()">
                                Crear Timelock
                            </button>
                        </div>
                        
                        <!-- Multisig Form -->
                        <div id="multisigForm" style="display: none;">
                            <div class="form-group">
                                <label>Firmas Requeridas</label>
                                <input type="number" id="requiredSigs" placeholder="2" min="1">
                            </div>
                            <div class="form-group">
                                <label>Firmantes (uno por l√≠nea)</label>
                                <textarea id="signers" rows="4" placeholder="Direcci√≥n 1&#10;Direcci√≥n 2&#10;Direcci√≥n 3"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Cantidad (CLC)</label>
                                <input type="number" id="multisigAmount" placeholder="50" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Destinatario</label>
                                <input type="text" id="multisigRecipient" placeholder="Direcci√≥n">
                            </div>
                            <button class="btn btn-primary" onclick="createMultisigContract()">
                                Crear Multisig
                            </button>
                        </div>
                        
                        <!-- Escrow Form -->
                        <div id="escrowForm" style="display: none;">
                            <div class="form-group">
                                <label>Comprador</label>
                                <input type="text" id="buyer" placeholder="Direcci√≥n del comprador">
                            </div>
                            <div class="form-group">
                                <label>Vendedor</label>
                                <input type="text" id="seller" placeholder="Direcci√≥n del vendedor">
                            </div>
                            <div class="form-group">
                                <label>√Årbitro</label>
                                <input type="text" id="arbiter" placeholder="Direcci√≥n del √°rbitro">
                            </div>
                            <div class="form-group">
                                <label>Cantidad (CLC)</label>
                                <input type="number" id="escrowAmount" placeholder="100" step="0.01">
                            </div>
                            <button class="btn btn-primary" onclick="createEscrowContract()">
                                Crear Escrow
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Contracts List -->
                <div class="section-card">
                    <h3>üìã Contratos Activos</h3>
                    <div id="contractsList">
                        <p class="loading">Cargando contratos...</p>
                    </div>
                </div>
            </div>

            <!-- Network Page -->
            <div class="page" id="network">
                <h2 class="page-title">üåê Red P2P</h2>
                
                <!-- Node Info -->
                <div class="section-card">
                    <h3>üì° Informaci√≥n del Nodo</h3>
                    <div id="nodeInfo">
                        <p class="loading">Cargando informaci√≥n del nodo...</p>
                    </div>
                </div>
                
                <!-- Peers -->
                <div class="section-card">
                    <h3>üë• Peers Conectados</h3>
                    <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                        <button class="btn btn-primary" onclick="showAddPeerModal()">
                            ‚ûï Agregar Peer
                        </button>
                        <button class="btn btn-secondary" onclick="syncNetwork()">
                            üîÑ Sincronizar Red
                        </button>
                        <button class="btn btn-secondary" onclick="loadNetworkPage()">
                            üîÉ Actualizar
                        </button>
                    </div>
                    <div id="peersList">
                        <p class="loading">Cargando peers...</p>
                    </div>
                </div>
                
                <!-- Network Stats -->
                <div class="section-card">
                    <h3>üìä Estad√≠sticas de Red</h3>
                    <div id="networkStats">
                        <p class="loading">Cargando estad√≠sticas...</p>
                    </div>
                </div>
            </div>
            
            <!-- Add Peer Modal -->
            <div id="addPeerModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
                <div style="background: var(--dark-light); padding: 2rem; border-radius: 12px; max-width: 500px; width: 90%;">
                    <h3>‚ûï Agregar Peer</h3>
                    <div class="form-group">
                        <label>Host/IP</label>
                        <input type="text" id="peerHost" placeholder="127.0.0.1">
                    </div>
                    <div class="form-group">
                        <label>Puerto</label>
                        <input type="number" id="peerPort" placeholder="5000">
                    </div>
                    <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="addPeer()">Agregar</button>
                        <button class="btn btn-secondary" onclick="closeAddPeerModal()">Cancelar</button>
                    </div>
                </div>
            </div>
            <!-- Mining Pool Page -->
            <div class="page" id="pool">
                <h2 class="page-title">‚õèÔ∏è Mining Pool</h2>
                
                <!-- Pool Info -->
                <div class="section-card">
                    <h3>üìä Pool Information</h3>
                    <div id="poolInfo">
                        <p class="loading">Loading pool info...</p>
                    </div>
                </div>
                
                <!-- Join Pool -->
                <div class="section-card">
                    <h3>üë• Join Pool</h3>
                    <div class="form-group">
                        <label>Miner ID</label>
                        <input type="text" id="minerIdInput" placeholder="my-miner">
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-primary" onclick="joinPool()">
                            ‚ûï Join Pool
                        </button>
                        <button class="btn btn-secondary" onclick="leavePool()">
                            ‚ùå Leave Pool
                        </button>
                    </div>
                </div>
                
                <!-- Pool Mining -->
                <div class="section-card">
                    <h3>‚õèÔ∏è Collaborative Mining</h3>
                    <div id="poolMiningStatus" style="margin-bottom: 1rem;">
                        <p>Pool is ready to mine</p>
                    </div>
                    <button class="btn btn-primary" onclick="poolMine()">
                        ‚õèÔ∏è Mine Block (Pool)
                    </button>
                </div>
                
                <!-- Active Miners -->
                <div class="section-card">
                    <h3>üë∑ Active Miners</h3>
                    <div id="poolMinersList">
                        <p class="loading">Loading miners...</p>
                    </div>
                </div>
                
                <!-- Leaderboard -->
                <div class="section-card">
                    <h3>üèÜ Leaderboard</h3>
                    <div id="poolLeaderboard">
                        <p class="loading">Loading leaderboard...</p>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div class="page" id="settings">
                <h2 class="page-title">‚öôÔ∏è Ajustes de Dificultad</h2>
                
                <div class="settings-grid">
                    <div class="section-card">
                        <h3>Informaci√≥n Actual</h3>
                        <div id="difficultyInfo">
                            <p class="loading">Cargando...</p>
                        </div>
                    </div>

                    <div class="section-card">
                        <h3>Configuraci√≥n Manual</h3>
                        <div class="form-group">
                            <label>Dificultad (2-8)</label>
                            <input type="number" id="manualDifficulty" min="2" max="8" value="4">
                        </div>
                        <button class="btn btn-primary" onclick="setDifficulty()">
                            Aplicar Dificultad
                        </button>
                    </div>

                    <div class="section-card">
                        <h3>Ajuste Autom√°tico</h3>
                        <div class="toggle-group">
                            <label>
                                <input type="checkbox" id="autoAdjustToggle" checked>
                                <span>Habilitar ajuste autom√°tico</span>
                            </label>
                        </div>
                        <button class="btn btn-secondary" onclick="toggleAutoAdjust()">
                            Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>ü™ô ColCript v1.1.0 - Blockchain Educativa</p>
            <p>API: <a href="/api/docs" target="_blank">Documentaci√≥n</a></p>
        </div>
    </footer>

    <!-- Notification Toast -->
    <div id="toast" class="toast"></div>

    <!-- Scripts -->
    <script src="js/api.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
